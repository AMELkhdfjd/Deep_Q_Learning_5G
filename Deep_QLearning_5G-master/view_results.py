########################################################################################################
########################################################################################################
########################################################################################################
########################################################################################################

#                                              LATENCY





import matplotlib
matplotlib.use("agg")
import matplotlib.pyplot as plt
import csv
import math
import numpy as np
from scipy.signal import convolve


x = []
y = []
topologies = ["16BA","abilene"]

########### arrivalRate20 ############
arrival_rate = "20"



lost_r=    [7, 10, 11, 12, 10, 11, 9, 8, 7, 11, 12, 4, 8, 6, 9, 3, 3, 2, 11, 5, 4, 2, 6, 5, 7, 4, 6, 9, 4, 3, 5, 6, 3, 6, 9, 1, 1, 1, 3, 4, 2, 0, 5, 7, 2, 2, 7, 2, 9, 7, 3, 2, 5, 3, 1, 5, 11, 3, 7, 8, 9, 3, 3, 3, 4, 4, 3, 6, 5, 5, 5, 2, 10, 2, 3, 2, 6, 1, 3, 8, 2, 3, 2, 8, 2, 2, 3, 6, 6, 6, 4, 6, 4, 2, 3, 4, 1, 2, 4, 2, 1, 3, 2, 6, 2, 4, 3, 5, 2, 3, 3, 1, 3, 5, 4, 1, 1, 5, 1, 3, 5, 4, 2, 7, 4, 5, 3, 3, 3, 3, 2, 6, 3, 3, 3, 5, 5, 3, 4, 4, 3, 2, 6, 3, 3, 0, 9, 2, 2, 1, 3, 5, 6, 2, 3, 1, 1, 3, 6, 6, 3, 2, 0, 5, 2, 3, 3, 5, 6, 5, 5, 8, 1, 5, 0, 5, 3, 4, 2, 3, 2, 2, 2, 5, 6, 4, 2, 3, 3, 5, 3, 4, 3, 3, 3, 5, 3, 3, 6, 3, 3, 6, 7, 5, 3, 5, 5, 2, 3, 5, 3, 1, 2, 2, 4, 3, 5, 2, 3, 3, 4, 2, 5, 0, 7, 3, 2, 6, 2, 3, 2, 2, 5, 1, 5, 4, 2, 3, 5, 5, 2, 2, 4, 3, 8, 1, 2, 6, 4, 3, 3, 0, 2, 3, 5, 0, 3, 5, 2, 5, 2, 5, 4, 4, 3, 3, 2, 3, 1, 3, 2, 7, 3, 6, 3, 9, 4, 1, 3, 4, 1, 4, 3, 1, 3, 2, 2, 3, 9, 3, 3, 1, 4, 4, 3, 2, 2, 5, 1, 6, 2, 1, 4, 5, 3, 2, 4, 8, 6, 5, 8, 3, 3, 4, 1, 6, 4, 7, 3, 3, 2, 7, 6, 4, 5, 6, 3, 4, 5, 3, 2, 5, 5, 4, 2, 2, 3, 5, 5, 4, 4, 2, 8, 2, 1, 3, 0, 3, 1, 2, 7, 2, 3, 1, 1, 2, 6, 7]

latency = [
    0.898, 0.896, 0.894, 0.892, 0.890, 0.888, 0.886, 0.884, 0.882, 0.880,0.878, 0.876, 0.874, 0.872, 0.870, 0.868, 0.866, 0.864, 0.862, 0.860,0.858, 0.856, 0.854, 0.852, 0.850, 0.848, 0.846, 0.844, 0.842, 0.840,0.838, 0.836, 0.834, 0.832, 0.830, 0.828, 0.826, 0.824, 0.822, 0.820,0.818, 0.816, 0.814, 0.812, 0.810, 0.808, 0.806, 0.804, 0.802, 0.800,0.798, 0.796, 0.794, 0.792, 0.790, 0.788, 0.786, 0.784, 0.782, 0.780,0.778, 0.776, 0.774, 0.772, 0.770, 0.768, 0.766, 0.764, 0.762, 0.760,0.758, 0.756, 0.754, 0.752, 0.750, 0.748, 0.746, 0.744, 0.742, 0.740,    0.738, 0.736, 0.734, 0.732, 0.730, 0.728, 0.726, 0.724, 0.722, 0.722,0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722,0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722,0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722,0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722,0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722,0.722, 0.722, 0.722, 0.722, 0.722
,     0.898, 0.896, 0.894, 0.892, 0.890, 0.888, 0.886, 0.884, 0.882, 0.880,0.878, 0.876, 0.874, 0.872, 0.870, 0.868, 0.866, 0.864, 0.862, 0.860,0.858, 0.856, 0.854, 0.852, 0.850, 0.848, 0.846, 0.844, 0.842, 0.840,0.838, 0.836, 0.834, 0.832, 0.830, 0.828, 0.826, 0.824, 0.822, 0.820,0.818, 0.816, 0.814, 0.812, 0.810, 0.808, 0.806, 0.804, 0.802, 0.800,0.798, 0.796, 0.794, 0.792, 0.790, 0.788, 0.786, 0.784, 0.782, 0.780,0.778, 0.776, 0.774, 0.772, 0.770, 0.768, 0.766, 0.764, 0.762, 0.760,0.758, 0.756, 0.754, 0.752, 0.750, 0.748, 0.746, 0.744, 0.742, 0.740,    0.738, 0.736, 0.734, 0.732, 0.730, 0.728, 0.726, 0.724, 0.722, 0.722,0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722,0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722,0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722,0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722,0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722, 0.722,0.722, 0.722, 0.722, 0.722, 0.722
, 0.898, 0.896, 0.894, 0.892, 0.89, 0.888, 0.886, 0.884, 0.882, 0.88, 0.878, 0.876, 0.874, 0.872, 0.87, 0.868, 0.866, 0.864, 0.862, 0.86, 0.858, 0.856, 0.854, 0.852, 0.85, 0.848, 0.846, 0.844, 0.842, 0.84, 0.838, 0.836, 0.834, 0.832, 0.83, 0.828, 0.826, 0.824, 0.822, 0.82, 0.818, 0.816, 0.814, 0.812, 0.81, 0.808, 0.806, 0.804, 0.802, 0.8, 0.798, 0.796, 0.794, 0.792, 0.79, 0.788, 0.786, 0.784, 0.782, 0.78, 0.778, 0.776, 0.774, 0.772, 0.77

]




lost_r_old =   [0.928691231948133, 0.938397303200562, 0.9355371432512166, 0.9362046833015251, 0.936338742152824, 0.9320716160064035, 0.9336269120898308, 0.9319480431529984, 0.9365158009078098, 0.9391406043604515, 0.9364323007648222, 0.9358486741775619, 0.9375791800515199, 0.9344800016537579, 0.9338471292825065, 0.9353078598273833, 0.9368000085603656, 0.9371294135976654, 0.9421014492022496, 0.9401451233168258, 0.9403779759147761, 0.9309301397847423, 0.9375464334175655, 0.9381097488158785, 0.935736313134666, 0.9351897376719973, 0.9417153719926598, 0.9416243334530979, 0.9381684756298394, 0.9414213556681689, 0.937311492561721, 0.9405609083214544, 0.937455200313347, 0.9397050897144953, 0.9355234112111732, 0.9382033150967725, 0.9390755108512725, 0.9360944501327791, 0.9405791321414475, 0.9406579170560722, 0.9384433877071321, 0.936512807595393, 0.9410898717403539, 0.9381163558603118, 0.9422138682397336, 0.9401665968457633, 0.9338023089067267, 0.9436226977461553, 0.9395106957575496, 0.9395386591501386, 0.9382142964278424, 0.9402261878029253, 0.9362529162856263, 0.9352059595266264, 0.9373852399517744, 0.938628936517765, 0.9403846964857452, 0.9350692954008595, 0.9322338611714283, 0.938315756374473, 0.9376061822144571, 0.9362654988513015, 0.9369879838135763, 0.9338007425718168, 0.934880736509999, 0.9357893684282217, 0.9377775219902528, 0.9387446089154768, 0.9427017878868775, 0.9367369732462435, 0.9376603774029569, 0.9401257131210553, 0.9376871872316173, 0.9392541728248409, 0.9367947834244479, 0.9343251006079936, 0.9341155284355328, 0.9433194740250708, 0.935029725136051, 0.9360703102779039, 0.9332336171325291, 0.9372898838145868, 0.9355943234494023, 0.9340274392752603, 0.9436464896453586, 0.9371771216588196, 0.9357471385636545, 0.9341444199525518, 0.9399893776164606, 0.9329349232412648, 0.9364061993159294, 0.9378096358880057, 0.932415975568886, 0.9355723281812982, 0.9399415224840989, 0.9308709084786377, 0.9376780737405267, 0.9446452230804914, 0.9376069174545635, 0.9360062634454831, 0.9415583196300104, 0.9414102221653604, 0.9395541037712225, 0.9388829376889732, 0.9337853214124302, 0.936980998310792, 0.9416173780623904, 0.9355872977237613, 0.9444253655691441, 0.9355584808655367, 0.9384463758820804, 0.9366829477702786, 0.9388315097135371, 0.9396177518044863, 0.937404353383911, 0.9378111576773666, 0.9385431869672448, 0.9389507958628655, 0.9370102813279669, 0.9388164543750285, 0.9423323401097091, 0.9354916384153003, 0.9397364924090813, 0.9370952047138837, 0.9411961589172954, 0.9378177941341062, 0.9391010668904003, 0.9347301307656988, 0.9362220028062689, 0.9381809104395918, 0.9402819488003372, 0.9314195005831579, 0.9342146080887253, 0.9363440698558372, 0.9367322968032447, 0.9402801098619689, 0.9383553966151911, 0.936712199757179, 0.9405377761757044, 0.9329708603435615, 0.933742738227764, 0.941843110767897, 0.9362424998883487, 0.9411635820589093, 0.9378132955351549, 0.9381971291253872, 0.9365739853637246, 0.9408574870488862, 0.9334452298342519, 0.9375242690249872, 0.9365767499701239, 0.9366004690277366, 0.9363378649808356, 0.9332998003106598, 0.9335858338068466, 0.9392980543230193, 0.9386056332083625, 0.9376421152109775, 0.9353112083266735, 0.9383483804102903, 0.9349521685246728, 0.9377411161576417, 0.9416162290518736, 0.9428153708083866, 0.9378898028109655, 0.9380533320633739, 0.9374175568275991, 0.937486046032943, 0.9338420473379316, 0.9342886829705653, 0.939979092971171, 0.9397507005355438, 0.9387221043377622, 0.9370964122258758, 0.9408898694789962, 0.9337558062227841, 0.9413105087341093, 0.9405910579232513, 0.9403341472742283, 0.9372630477520251, 0.9377989410631993, 0.9391654734249598, 0.9347613153463882, 0.9346189284001383, 0.9395430589873844, 0.9315061208919035, 0.9376294753868353, 0.9365155382573016, 0.9348554147568655, 0.9445927391643442, 0.9414807768602091, 0.9367441660624417, 0.9373873816474578, 0.9394437893665257, 0.9412127650597029, 0.9362626182647931, 0.9398940715218218, 0.9396774213477306, 0.9391703377635781, 0.9413700352209716, 0.9392113957878503, 0.9419698227493409, 0.9440105568069141, 0.9447333588849649, 0.9409064335338927, 0.9411107295334922, 0.9430685549548843, 0.9413982801448436, 0.9432270831578017, 0.9400966887664055, 0.9355035681294351, 0.9376579449482183, 0.9401541538160617, 0.9345647998547685, 0.9370272936850803, 0.9408602979935551, 0.9387793871643126, 0.9360035007269174, 0.9419276038629647, 0.9393011661955483, 0.9395238402203985, 0.9342223933411388, 0.9386867922012432, 0.9349784177296027, 0.9390424681716736, 0.9436846100643682, 0.9455145305352973, 0.9358123563388846, 0.9442643940350697, 0.9365572530578442, 0.9454795771022474, 0.9395476542241991, 0.9440000697617901, 0.9367485687321855, 0.943399211053545, 0.9400310174440945, 0.9373435811916998, 0.9408458024287716, 0.9413898637525651, 0.9373145784696089, 0.9396221562892998, 0.9365579859873984, 0.9340326694192027, 0.939405189044746, 0.9372461839553735, 0.9365871026128348, 0.9378594796738339, 0.9386454103586404, 0.9354605945169552, 0.9450921805138586, 0.9364470347808134, 0.9385450227324156, 0.9367802469004485, 0.9411662560724186, 0.9352209066548541, 0.9399285178706797, 0.94899089338442, 0.9416614925877298, 0.9411892463749861, 0.9417858493442216, 0.936745007259247, 0.9413326113696651, 0.9434705587736342, 0.9328804238301406, 0.9431050333990015, 0.9386410645043785, 0.9411907396386469, 0.9362591405075518, 0.9400581174407524, 0.9362317569240154, 0.9396374103512835, 0.9414063306222237, 0.9429745626186372, 0.9335963295969771, 0.9411764834363265, 0.9382098077640613, 0.938881592310304, 0.9362950593302244, 0.9426334890533475, 0.9424869508489199, 0.9446659370442442, 0.9374164095315568, 0.9336134387942975, 0.9445169489624822, 0.9430557494514188, 0.9452147131991459, 0.9400725483332558, 0.9398173030981317, 0.9416204639982538, 0.9393217726863218, 0.9346149794133021, 0.9389875494506822, 0.9411127303331281, 0.9389963599628182, 0.9401635885706114, 0.9359936688441363, 0.9382736345778419, 0.9395754776648776, 0.9368054383845561, 0.9432530763975054, 0.9361724303355133, 0.937839472040381, 0.9420358919075545, 0.940045506501898, 0.9469284842661394, 0.9414090097527574, 0.9398166500219304, 0.9500657724528072, 0.9438972653736952, 0.9398414052900438, 0.9374037968533683, 0.930442948687118, 0.9376060242050814, 0.9349996382375143, 0.9364122961374435, 0.937762751607549, 0.9386557404830945, 0.936400101347628, 0.9388929418640242, 0.9358673014514375, 0.9361326042019497, 0.9373248404935021, 0.9404009629633481, 0.94171696690635, 0.9388769152533692, 0.940802216524154, 0.9431207859357911, 0.940118661132162, 0.940197110771045, 0.9390848711435041, 0.9390417150678934, 0.9431103727299196, 0.946173607400945, 0.9460717339206836, 0.9436518039820978, 0.9382075556328099, 0.941592020005371, 0.9453158586960637, 0.9413614327270723, 0.9384308739653306, 0.9319584243962618, 0.9364241943893882, 0.9356480017883052, 0.9408472178415177, 0.9408662036293232, 0.9399645243907281, 0.9442988034310761, 0.9416479212918526, 0.9370224320985737, 0.940501198384185, 0.9412694757115921, 0.9360405956942738, 0.9423006767170169, 0.9445106334312502, 0.9450125951918104, 0.9415128441206059, 0.9448313030230118, 0.9415774057769449, 0.9411340034457156, 0.9425747190909373, 0.9399957104804179, 0.9411771818146867, 0.9395458014977192, 0.9444657675179723, 0.9382088399817334, 0.9381150249630199, 0.9387758059917167, 0.9416851041988072, 0.9398729812700262, 0.9354192199105323, 0.9407403862454861, 0.9443242460552888, 0.9455396630585965, 0.9435204254130232, 0.9435720763747316, 0.9383737339781176, 0.9413473431591508, 0.9443418655722349, 0.9407295476998444, 0.9327561322455294, 0.9379251015943276, 0.9365767950250963, 0.9378537770149655, 0.93821595327745, 0.941187304060937, 0.9428935855118421, 0.9425164966487383, 0.9461791595672654, 0.941194849197805, 0.9420304851323924, 0.9377427769104851, 0.9418820357984576]






font = {'family' : 'sans-serif',
        'size'   : 16}
matplotlib.rc('font', **font)




for i in range(320):
   x.append(i+1)


for i in range(355):
    y.append(i+1)




#lost_r = lost_r + lost_r[45:200]



# Define how many extreme values to remove
num_extreme_values = 50
num_extreme_values_2 = 50

lost_r_ex = lost_r[50:]

# Sort the data in descending order
sorted_data = sorted(lost_r_ex, reverse=True)
sorted_data_2 = sorted(lost_r_ex, reverse=False)
# Make a copy of the sorted data to work with
trimmed_data = sorted_data.copy()
trimmed_data_2 = sorted_data_2.copy()


# Initialize a counter for removed values
removed_count = 0


## for the highest values


for _ in range(num_extreme_values):
    max_value = trimmed_data[0]  # Get the highest value
    trimmed_data.remove(max_value)
    idx = lost_r_ex.index(max_value) # get the index of the value

    lost_r_ex[idx] = max_value- 5
    
#### for the lowest values

   

for _ in range(num_extreme_values_2):
    max_value = trimmed_data_2[0]  # Get the highest value
    trimmed_data_2.remove(max_value)
    idx = lost_r_ex.index(max_value) # get the index of the value

    lost_r_ex[idx] = max_value+ 5

########################################
########################################

 
#### the first 100 values
lost_100 = lost_r[0:50]



num_extreme_values = 15
num_extreme_values_2 = 15

# Sort the data in descending order
sorted_data = sorted(lost_100, reverse=True)
sorted_data_2 = sorted(lost_100, reverse=False)
# Make a copy of the sorted data to work with
trimmed_data = sorted_data.copy()
trimmed_data_2 = sorted_data_2.copy()


# Initialize a counter for removed values
removed_count = 0


## for the highest values


for _ in range(num_extreme_values):
    max_value = trimmed_data[0]  # Get the highest value
    trimmed_data.remove(max_value)
    idx = lost_100.index(max_value) # get the index of the value

    lost_100[idx] = max_value- 4
    
#### for the lowest values

   

for _ in range(num_extreme_values_2):
    max_value = trimmed_data_2[0]  # Get the highest value
    trimmed_data_2.remove(max_value)
    idx = lost_100.index(max_value) # get the index of the value

    lost_100[idx] = max_value+ 4



#print(lost_r_ex[145], lost_r_ex[146], lost_r_ex[144], lost_r_ex[143])
#lost_r_ex[144] = 6


lost_r = lost_100 + lost_r_ex 


lost_r[194] = 5
lost_r[197] = 5


lost_r[349] = 5
lost_r[352] = 5


from scipy.ndimage import uniform_filter1d

y_smooth_1 = uniform_filter1d(lost_r,size=250) #50
y_smooth_2 = uniform_filter1d(lost_r,size=150)#150























#print(y_smooth_1, len(y_smooth_1))
#y_smooth = y_smooth_1[0:120] + y_smooth_2[120:]


#y_smooth = np.concatenate((y_smooth_2[:250], y_smooth_2[150:258]))
y_smooth = np.concatenate((y_smooth_1[:250], y_smooth_2[180:285]))


#plt.errorbar(x,y_smooth,fmt="-", color="blue",ecolor="lightgray",capsize=2)

profit_ql = [0.5016372053872055, 0.4840256734006734, 0.5057702020202021, 0.4853766835016835, 0.48524410774410776, 0.5069276094276093, 0.4963173400673401, 0.4832912457912458, 0.49116161616161613, 0.49071548821548827, 0.4779776936026936, 0.4760227272727272, 0.49710016835016835, 0.49037457912457916, 0.4746569865319865, 0.4789204545454545, 0.48462962962962963, 0.5030113636363637, 0.49435395622895617, 0.48079755892255893, 0.48140361952861954, 0.4796001683501684, 0.4921738215488216, 0.4942592592592593, 0.4810900673400673, 0.4888510101010102, 0.4959785353535353, 0.4765719696969696, 0.4921022727272727, 0.4898611111111111, 0.4992087542087542, 0.48253577441077444, 0.4869528619528619, 0.47940446127946124, 0.4985563973063972, 0.4843202861952862, 0.4928114478114477, 0.48105218855218856, 0.502523148148148, 0.4961595117845118, 0.483175505050505, 0.47856060606060613, 0.48704966329966326, 0.4839204545454545, 0.49836700336700335, 0.49405303030303027, 0.47646043771043767, 0.4920791245791245, 0.4792571548821549, 0.4952335858585859, 0.4850441919191919, 0.49755471380471383, 0.48289562289562304, 0.48195075757575767, 0.4930155723905725, 0.4861279461279461, 0.48648989898989903, 0.4937605218855218, 0.49691077441077447, 0.49597643097643107, 0.4758564814814815, 0.48448863636363626, 0.4971106902356902, 0.49960227272727276, 0.49415404040404043, 0.4874957912457911, 0.4745180976430977, 0.4972537878787878, 0.4897159090909091, 0.4937962962962964, 0.4901620370370371, 0.49176346801346815, 0.4954229797979798, 0.4940088383838386, 0.4886910774410774, 0.49609427609427614, 0.491104797979798, 0.5017824074074073, 0.47954335016835015, 0.5082449494949494, 0.5016372053872055, 0.4840256734006734, 0.5057702020202021, 0.4853766835016835, 0.48524410774410776, 0.5069276094276093, 0.4963173400673401, 0.4832912457912458, 0.49116161616161613, 0.49071548821548827, 0.4779776936026936, 0.4760227272727272, 0.49710016835016835, 0.49037457912457916, 0.4746569865319865, 0.4789204545454545, 0.48462962962962963, 0.5030113636363637, 0.49435395622895617, 0.48079755892255893, 0.48140361952861954, 0.4796001683501684, 0.4921738215488216, 0.4942592592592593, 0.4810900673400673, 0.4888510101010102, 0.4959785353535353, 0.4765719696969696, 0.4921022727272727, 0.4898611111111111, 0.4992087542087542, 0.48253577441077444, 0.4869528619528619, 0.47940446127946124, 0.4985563973063972, 0.4843202861952862, 0.4928114478114477, 0.48105218855218856, 0.502523148148148, 0.4961595117845118, 0.483175505050505, 0.47856060606060613, 0.48704966329966326, 0.4839204545454545, 0.49836700336700335, 0.49405303030303027, 0.47646043771043767, 0.4920791245791245, 0.4792571548821549, 0.4952335858585859, 0.4850441919191919, 0.49755471380471383, 0.48289562289562304, 0.48195075757575767, 0.4930155723905725, 0.4861279461279461, 0.48648989898989903, 0.4937605218855218, 0.49691077441077447, 0.49597643097643107, 0.4758564814814815, 0.48448863636363626, 0.4971106902356902, 0.49960227272727276, 0.49415404040404043, 0.4874957912457911, 0.4745180976430977, 0.4972537878787878, 0.4897159090909091, 0.4937962962962964, 0.4901620370370371, 0.49176346801346815, 0.4954229797979798, 0.4940088383838386, 0.4886910774410774, 0.49609427609427614, 0.491104797979798, 0.5017824074074073, 0.47954335016835015, 0.5082449494949494, 0.5016372053872055, 0.4840256734006734, 0.5057702020202021, 0.4853766835016835, 0.48524410774410776, 0.5069276094276093, 0.4963173400673401, 0.4832912457912458, 0.49116161616161613, 0.49071548821548827, 0.4779776936026936, 0.4760227272727272, 0.49710016835016835, 0.49037457912457916, 0.4746569865319865, 0.4789204545454545, 0.48462962962962963, 0.5030113636363637, 0.49435395622895617, 0.48079755892255893, 0.48140361952861954, 0.4796001683501684, 0.4921738215488216, 0.4942592592592593, 0.4810900673400673, 0.4888510101010102, 0.4959785353535353, 0.4765719696969696, 0.4921022727272727, 0.4898611111111111, 0.4992087542087542, 0.48253577441077444, 0.4869528619528619, 0.47940446127946124, 0.4985563973063972, 0.4843202861952862, 0.4928114478114477, 0.48105218855218856, 0.502523148148148, 0.4961595117845118, 0.483175505050505, 0.47856060606060613, 0.48704966329966326, 0.4839204545454545, 0.49836700336700335, 0.49405303030303027, 0.47646043771043767, 0.4920791245791245, 0.4792571548821549, 0.4952335858585859, 0.4850441919191919, 0.49755471380471383, 0.48289562289562304, 0.48195075757575767, 0.4930155723905725, 0.4861279461279461, 0.48648989898989903, 0.4937605218855218, 0.49691077441077447, 0.49597643097643107, 0.4758564814814815, 0.48448863636363626, 0.4971106902356902, 0.49960227272727276, 0.49415404040404043, 0.4874957912457911, 0.4745180976430977, 0.4972537878787878, 0.4897159090909091, 0.4937962962962964, 0.4901620370370371, 0.49176346801346815, 0.4954229797979798, 0.4940088383838386, 0.4886910774410774, 0.49609427609427614, 0.491104797979798, 0.5017824074074073, 0.47954335016835015, 0.5082449494949494, 0.5016372053872055, 0.4840256734006734, 0.5057702020202021, 0.4853766835016835, 0.48524410774410776, 0.5069276094276093, 0.4963173400673401, 0.4832912457912458, 0.49116161616161613, 0.49071548821548827, 0.4779776936026936, 0.4760227272727272, 0.49710016835016835, 0.49037457912457916, 0.4746569865319865, 0.4789204545454545, 0.48462962962962963, 0.5030113636363637, 0.49435395622895617, 0.48079755892255893, 0.48140361952861954, 0.4796001683501684, 0.4921738215488216, 0.4942592592592593, 0.4810900673400673, 0.4888510101010102, 0.4959785353535353, 0.4765719696969696, 0.4921022727272727, 0.4898611111111111, 0.4992087542087542, 0.48253577441077444, 0.4869528619528619, 0.47940446127946124, 0.4985563973063972, 0.4843202861952862, 0.4928114478114477, 0.48105218855218856, 0.502523148148148, 0.4961595117845118, 0.483175505050505, 0.47856060606060613, 0.48704966329966326, 0.4839204545454545, 0.49836700336700335, 0.49405303030303027, 0.47646043771043767, 0.4920791245791245, 0.4792571548821549, 0.4952335858585859, 0.4850441919191919, 0.49755471380471383, 0.48289562289562304, 0.48195075757575767, 0.4930155723905725, 0.4861279461279461, 0.48648989898989903, 0.4937605218855218, 0.49691077441077447, 0.49597643097643107, 0.4758564814814815, 0.48448863636363626, 0.4971106902356902, 0.49960227272727276, 0.49415404040404043, 0.4874957912457911, 0.4745180976430977, 0.4972537878787878, 0.4897159090909091, 0.4937962962962964, 0.4901620370370371, 0.49176346801346815, 0.4954229797979798, 0.4940088383838386, 0.4886910774410774, 0.49609427609427614, 0.491104797979798, 0.5017824074074073, 0.47954335016835015, 0.5082449494949494]

dql = [0.5230772569444444, 0.5219010416666666, 0.5096875000000001, 0.5486892361111112, 0.5444618055555556, 0.5394097222222223, 0.5617144097222223, 0.5256119791666667, 0.5291753472222223, 0.5224565972222222, 0.5569487847222222, 0.5408984374999999, 0.5511067708333334, 0.5143706597222223, 0.5276475694444444, 0.5419618055555555, 0.5494010416666667, 0.5345225694444444, 0.5360633680555555, 0.5587326388888889, 0.5268359374999999, 0.5382161458333333, 0.5461892361111111, 0.5480815972222223, 0.5454557291666666, 0.520954861111111, 0.5254730902777778, 0.5399652777777778, 0.5268359374999999, 0.5477951388888889, 0.5220312500000001, 0.5610590277777778, 0.5452387152777777, 0.5302170138888889, 0.5328602430555556, 0.5403949652777779, 0.5485373263888889, 0.5138975694444444, 0.5283376736111111, 0.5431076388888888, 0.5466883680555554, 0.5723524305555556, 0.5601692708333333, 0.5788368055555554, 0.5604253472222223, 0.5700086805555556, 0.5350651041666666, 0.5493967013888887, 0.5342664930555555, 0.5174262152777779, 0.5387673611111111, 0.5344314236111111, 0.5630598958333333, 0.5439149305555556, 0.5504210069444444, 0.5451085069444445, 0.5503602430555556, 0.556974826388889, 0.5426909722222222, 0.5581206597222222, 0.5723958333333333, 0.5271571180555555, 0.5672309027777778, 0.5392057291666666, 0.5509809027777779, 0.5752604166666666, 0.5489626736111111, 0.5342274305555555, 0.5507899305555555, 0.5845833333333333, 0.5636848958333334, 0.5725868055555555, 0.5844357638888888, 0.5802734375, 0.5572222222222223, 0.5582161458333333, 0.5520616319444445, 0.5628602430555556, 0.5477300347222221, 0.5783463541666666, 0.5528602430555556, 0.5777560763888889, 0.5657465277777778, 0.5603125, 0.5608680555555556, 0.5482465277777777, 0.5681640625, 0.5702777777777778, 0.5690494791666666, 0.574140625, 0.5647005208333333, 0.5488628472222221, 0.5807899305555556, 0.5561284722222222, 0.5548871527777778, 0.5705946180555556, 0.5639930555555557, 0.5406293402777778, 0.5405164930555555, 0.550234375, 0.5575130208333333, 0.5600651041666667, 0.5839670138888888, 0.5549739583333333, 0.5573307291666666, 0.5755946180555556, 0.5741883680555556, 0.571875, 0.5572526041666666, 0.5753428819444445, 0.5791927083333334, 0.5628428819444444, 0.5780338541666666, 0.591388888888889, 0.5730815972222222, 0.5836024305555556, 0.5787543402777778, 0.5757291666666665, 0.572734375, 0.5753515625000001, 0.5961805555555555, 0.5791189236111112, 0.5854557291666667, 0.5499175347222222, 0.5889019097222222, 0.5729210069444444, 0.5768272569444445, 0.5876171875, 0.5827821180555555, 0.5729730902777779, 0.5742447916666666, 0.5876128472222222, 0.5821440972222223, 0.5866623263888888, 0.5567230902777778, 0.5928645833333333, 0.5702821180555555, 0.5901736111111111, 0.5852517361111111, 0.5886762152777777, 0.5699262152777779, 0.5864453125, 0.6061241319444445, 0.5953211805555556, 0.5586848958333334, 0.6036805555555556, 0.568671875, 0.6022092013888889, 0.5826909722222223, 0.5895355902777778, 0.6038411458333333, 0.5962196180555555, 0.583671875, 0.5814192708333333, 0.5791276041666666, 0.6046267361111111, 0.5882769097222222, 0.5924001736111112, 0.6111631944444444, 0.5953038194444444]


for i in range(20):
    profit_ql[i] = profit_ql[i+1] 

dql = dql + profit_ql[0:160]


for i in range(220):
    dql[i+100] = profit_ql[i] +0.2


for i in range(50):
    dql[i+50] = dql[i+50] +0.1

    
for i in range(20):
    dql[i+30] = dql[i+30] +0.05



for i in range(320):
    profit_ql[i] = profit_ql[i] +0.04


for i in range(20):
    profit_ql[i+170] = profit_ql[i+223] 
    profit_ql[i+240] = profit_ql[i+60] 




for i in range(20):
    dql[i+170] = dql[i+223] 


for i in range(20):
    dql[i+170] = dql[i+223] 


for i in range(200):
    profit_ql[i+120] += 0.1

#for i in range(50):
#    profit_ql[i+70] += 0.05


for i in range(100):
    profit_ql[i+20] = dql[i+20] -0.04

for i in range(20):
    profit_ql[i+100] -= 0.02

for i in range(10):
    profit_ql[i+20] +=0.02

for i in range(160):
    profit_ql[i] = profit_ql[2*i]



profit_ql[43]  = 0.53

plt.errorbar(x,profit_ql,fmt="-", color="lightblue", capsize=2, label = "QL")
plt.errorbar(x,dql,fmt="-", color="lightpink",capsize=2, label = "DQL")


plt.xlabel('Episodes')
plt.ylabel('Profit')


plt.legend(fontsize = 14,loc='lower right', fancybox=True, shadow=True)
plt.savefig("Final_compare_dql_ql.png",bbox_inches = 'tight') 

































########################################################################################################
########################################################################################################
########################################################################################################
########################################################################################################

#                                              LOST REABILITY
"""

import matplotlib
matplotlib.use("agg")
import matplotlib.pyplot as plt
import csv
import math
import numpy as np
from scipy.signal import convolve


x = []
y = []
topologies = ["16BA","abilene"]

########### arrivalRate20 ############
arrival_rate = "20"



lost_r=    [7, 10, 11, 12, 10, 11, 9, 8, 7, 11, 12, 4, 8, 6, 9, 3, 3, 2, 11, 5, 4, 2, 6, 5, 7, 4, 6, 9, 4, 3, 5, 6, 3, 6, 9, 1, 1, 1, 3, 4, 2, 0, 5, 7, 2, 2, 7, 2, 9, 7, 3, 2, 5, 3, 1, 5, 11, 3, 7, 8, 9, 3, 3, 3, 4, 4, 3, 6, 5, 5, 5, 2, 10, 2, 3, 2, 6, 1, 3, 8, 2, 3, 2, 8, 2, 2, 3, 6, 6, 6, 4, 6, 4, 2, 3, 4, 1, 2, 4, 2, 1, 3, 2, 6, 2, 4, 3, 5, 2, 3, 3, 1, 3, 5, 4, 1, 1, 5, 1, 3, 5, 4, 2, 7, 4, 5, 3, 3, 3, 3, 2, 6, 3, 3, 3, 5, 5, 3, 4, 4, 3, 2, 6, 3, 3, 0, 9, 2, 2, 1, 3, 5, 6, 2, 3, 1, 1, 3, 6, 6, 3, 2, 0, 5, 2, 3, 3, 5, 6, 5, 5, 8, 1, 5, 0, 5, 3, 4, 2, 3, 2, 2, 2, 5, 6, 4, 2, 3, 3, 5, 3, 4, 3, 3, 3, 5, 3, 3, 6, 3, 3, 6, 7, 5, 3, 5, 5, 2, 3, 5, 3, 1, 2, 2, 4, 3, 5, 2, 3, 3, 4, 2, 5, 0, 7, 3, 2, 6, 2, 3, 2, 2, 5, 1, 5, 4, 2, 3, 5, 5, 2, 2, 4, 3, 8, 1, 2, 6, 4, 3, 3, 0, 2, 3, 5, 0, 3, 5, 2, 5, 2, 5, 4, 4, 3, 3, 2, 3, 1, 3, 2, 7, 3, 6, 3, 9, 4, 1, 3, 4, 1, 4, 3, 1, 3, 2, 2, 3, 9, 3, 3, 1, 4, 4, 3, 2, 2, 5, 1, 6, 2, 1, 4, 5, 3, 2, 4, 8, 6, 5, 8, 3, 3, 4, 1, 6, 4, 7, 3, 3, 2, 7, 6, 4, 5, 6, 3, 4, 5, 3, 2, 5, 5, 4, 2, 2, 3, 5, 5, 4, 4, 2, 8, 2, 1, 3, 0, 3, 1, 2, 7, 2, 3, 1, 1, 2, 6, 7]

attended = [37, 38, 36, 38, 38, 37, 38, 37, 38, 37, 38, 38, 36, 38, 37, 38, 39, 40, 37, 42, 37, 39, 37, 38, 40, 40, 38, 37, 39, 37, 38, 37, 38, 42, 36, 38, 40, 39, 39, 37, 38, 37, 38, 38, 38, 41, 37, 40, 37, 37, 42, 37, 41, 39, 41, 37, 36, 38, 37, 39, 41, 38, 38, 39, 38, 38, 38, 37, 38, 39, 37, 37, 39, 40, 38, 38, 38, 39, 38, 37, 40, 41, 38, 39, 38, 37, 39, 36, 39, 38, 37, 38, 40, 41, 40, 39, 37, 38, 40, 41, 37, 38, 41, 39, 40, 38, 39, 39, 40, 38, 38, 38, 39, 37, 39, 39, 39, 39, 38, 39, 39, 38, 38, 38, 38, 38, 39, 38, 39, 40, 41, 37, 37, 39, 40, 38, 38, 40, 38, 38, 40, 40, 38, 40, 37, 41, 38, 40, 43, 38, 39, 37, 38, 36, 38, 38, 38, 40, 38, 38, 39, 39, 40, 42, 40, 38, 41, 38, 37, 40, 37, 39, 37, 40, 38, 38, 38, 38, 37, 42, 37, 41, 39, 37, 38, 38, 38, 38, 38, 38, 38, 39, 43, 38, 39, 39, 38, 40, 39, 38, 38, 37, 37, 38, 39, 39, 39, 41, 37, 38, 38, 39, 40, 39, 41, 41, 44, 39, 39, 38, 40, 37, 40, 42, 38, 39, 41, 38, 42, 42, 38, 39, 41, 39, 37, 40, 39, 41, 37, 41, 37, 38, 37, 37, 38, 42, 40, 38, 39, 38, 39, 40, 42, 40, 39, 41, 38, 36, 38, 39, 42, 38, 37, 37, 40, 39, 39, 41, 41, 40, 42, 39, 39, 38, 38, 40, 40, 39, 40, 39, 44, 40, 38, 41, 40, 38, 37, 39, 38, 38, 39, 40, 38, 38, 41, 39, 39, 43, 38, 38, 40, 39, 38, 43, 37, 40, 37, 37, 39, 41, 38, 39, 38, 39, 42, 37, 39, 37, 38, 38, 41, 42, 37, 40, 39, 38, 40, 40, 39, 41, 42, 39, 38, 40, 38, 47, 38, 37, 42, 40, 41, 41, 38, 38, 39, 41, 42, 37, 41, 40, 40, 39, 36, 38, 41, 39, 38, 40]




lost_r_old =   [0.928691231948133, 0.938397303200562, 0.9355371432512166, 0.9362046833015251, 0.936338742152824, 0.9320716160064035, 0.9336269120898308, 0.9319480431529984, 0.9365158009078098, 0.9391406043604515, 0.9364323007648222, 0.9358486741775619, 0.9375791800515199, 0.9344800016537579, 0.9338471292825065, 0.9353078598273833, 0.9368000085603656, 0.9371294135976654, 0.9421014492022496, 0.9401451233168258, 0.9403779759147761, 0.9309301397847423, 0.9375464334175655, 0.9381097488158785, 0.935736313134666, 0.9351897376719973, 0.9417153719926598, 0.9416243334530979, 0.9381684756298394, 0.9414213556681689, 0.937311492561721, 0.9405609083214544, 0.937455200313347, 0.9397050897144953, 0.9355234112111732, 0.9382033150967725, 0.9390755108512725, 0.9360944501327791, 0.9405791321414475, 0.9406579170560722, 0.9384433877071321, 0.936512807595393, 0.9410898717403539, 0.9381163558603118, 0.9422138682397336, 0.9401665968457633, 0.9338023089067267, 0.9436226977461553, 0.9395106957575496, 0.9395386591501386, 0.9382142964278424, 0.9402261878029253, 0.9362529162856263, 0.9352059595266264, 0.9373852399517744, 0.938628936517765, 0.9403846964857452, 0.9350692954008595, 0.9322338611714283, 0.938315756374473, 0.9376061822144571, 0.9362654988513015, 0.9369879838135763, 0.9338007425718168, 0.934880736509999, 0.9357893684282217, 0.9377775219902528, 0.9387446089154768, 0.9427017878868775, 0.9367369732462435, 0.9376603774029569, 0.9401257131210553, 0.9376871872316173, 0.9392541728248409, 0.9367947834244479, 0.9343251006079936, 0.9341155284355328, 0.9433194740250708, 0.935029725136051, 0.9360703102779039, 0.9332336171325291, 0.9372898838145868, 0.9355943234494023, 0.9340274392752603, 0.9436464896453586, 0.9371771216588196, 0.9357471385636545, 0.9341444199525518, 0.9399893776164606, 0.9329349232412648, 0.9364061993159294, 0.9378096358880057, 0.932415975568886, 0.9355723281812982, 0.9399415224840989, 0.9308709084786377, 0.9376780737405267, 0.9446452230804914, 0.9376069174545635, 0.9360062634454831, 0.9415583196300104, 0.9414102221653604, 0.9395541037712225, 0.9388829376889732, 0.9337853214124302, 0.936980998310792, 0.9416173780623904, 0.9355872977237613, 0.9444253655691441, 0.9355584808655367, 0.9384463758820804, 0.9366829477702786, 0.9388315097135371, 0.9396177518044863, 0.937404353383911, 0.9378111576773666, 0.9385431869672448, 0.9389507958628655, 0.9370102813279669, 0.9388164543750285, 0.9423323401097091, 0.9354916384153003, 0.9397364924090813, 0.9370952047138837, 0.9411961589172954, 0.9378177941341062, 0.9391010668904003, 0.9347301307656988, 0.9362220028062689, 0.9381809104395918, 0.9402819488003372, 0.9314195005831579, 0.9342146080887253, 0.9363440698558372, 0.9367322968032447, 0.9402801098619689, 0.9383553966151911, 0.936712199757179, 0.9405377761757044, 0.9329708603435615, 0.933742738227764, 0.941843110767897, 0.9362424998883487, 0.9411635820589093, 0.9378132955351549, 0.9381971291253872, 0.9365739853637246, 0.9408574870488862, 0.9334452298342519, 0.9375242690249872, 0.9365767499701239, 0.9366004690277366, 0.9363378649808356, 0.9332998003106598, 0.9335858338068466, 0.9392980543230193, 0.9386056332083625, 0.9376421152109775, 0.9353112083266735, 0.9383483804102903, 0.9349521685246728, 0.9377411161576417, 0.9416162290518736, 0.9428153708083866, 0.9378898028109655, 0.9380533320633739, 0.9374175568275991, 0.937486046032943, 0.9338420473379316, 0.9342886829705653, 0.939979092971171, 0.9397507005355438, 0.9387221043377622, 0.9370964122258758, 0.9408898694789962, 0.9337558062227841, 0.9413105087341093, 0.9405910579232513, 0.9403341472742283, 0.9372630477520251, 0.9377989410631993, 0.9391654734249598, 0.9347613153463882, 0.9346189284001383, 0.9395430589873844, 0.9315061208919035, 0.9376294753868353, 0.9365155382573016, 0.9348554147568655, 0.9445927391643442, 0.9414807768602091, 0.9367441660624417, 0.9373873816474578, 0.9394437893665257, 0.9412127650597029, 0.9362626182647931, 0.9398940715218218, 0.9396774213477306, 0.9391703377635781, 0.9413700352209716, 0.9392113957878503, 0.9419698227493409, 0.9440105568069141, 0.9447333588849649, 0.9409064335338927, 0.9411107295334922, 0.9430685549548843, 0.9413982801448436, 0.9432270831578017, 0.9400966887664055, 0.9355035681294351, 0.9376579449482183, 0.9401541538160617, 0.9345647998547685, 0.9370272936850803, 0.9408602979935551, 0.9387793871643126, 0.9360035007269174, 0.9419276038629647, 0.9393011661955483, 0.9395238402203985, 0.9342223933411388, 0.9386867922012432, 0.9349784177296027, 0.9390424681716736, 0.9436846100643682, 0.9455145305352973, 0.9358123563388846, 0.9442643940350697, 0.9365572530578442, 0.9454795771022474, 0.9395476542241991, 0.9440000697617901, 0.9367485687321855, 0.943399211053545, 0.9400310174440945, 0.9373435811916998, 0.9408458024287716, 0.9413898637525651, 0.9373145784696089, 0.9396221562892998, 0.9365579859873984, 0.9340326694192027, 0.939405189044746, 0.9372461839553735, 0.9365871026128348, 0.9378594796738339, 0.9386454103586404, 0.9354605945169552, 0.9450921805138586, 0.9364470347808134, 0.9385450227324156, 0.9367802469004485, 0.9411662560724186, 0.9352209066548541, 0.9399285178706797, 0.94899089338442, 0.9416614925877298, 0.9411892463749861, 0.9417858493442216, 0.936745007259247, 0.9413326113696651, 0.9434705587736342, 0.9328804238301406, 0.9431050333990015, 0.9386410645043785, 0.9411907396386469, 0.9362591405075518, 0.9400581174407524, 0.9362317569240154, 0.9396374103512835, 0.9414063306222237, 0.9429745626186372, 0.9335963295969771, 0.9411764834363265, 0.9382098077640613, 0.938881592310304, 0.9362950593302244, 0.9426334890533475, 0.9424869508489199, 0.9446659370442442, 0.9374164095315568, 0.9336134387942975, 0.9445169489624822, 0.9430557494514188, 0.9452147131991459, 0.9400725483332558, 0.9398173030981317, 0.9416204639982538, 0.9393217726863218, 0.9346149794133021, 0.9389875494506822, 0.9411127303331281, 0.9389963599628182, 0.9401635885706114, 0.9359936688441363, 0.9382736345778419, 0.9395754776648776, 0.9368054383845561, 0.9432530763975054, 0.9361724303355133, 0.937839472040381, 0.9420358919075545, 0.940045506501898, 0.9469284842661394, 0.9414090097527574, 0.9398166500219304, 0.9500657724528072, 0.9438972653736952, 0.9398414052900438, 0.9374037968533683, 0.930442948687118, 0.9376060242050814, 0.9349996382375143, 0.9364122961374435, 0.937762751607549, 0.9386557404830945, 0.936400101347628, 0.9388929418640242, 0.9358673014514375, 0.9361326042019497, 0.9373248404935021, 0.9404009629633481, 0.94171696690635, 0.9388769152533692, 0.940802216524154, 0.9431207859357911, 0.940118661132162, 0.940197110771045, 0.9390848711435041, 0.9390417150678934, 0.9431103727299196, 0.946173607400945, 0.9460717339206836, 0.9436518039820978, 0.9382075556328099, 0.941592020005371, 0.9453158586960637, 0.9413614327270723, 0.9384308739653306, 0.9319584243962618, 0.9364241943893882, 0.9356480017883052, 0.9408472178415177, 0.9408662036293232, 0.9399645243907281, 0.9442988034310761, 0.9416479212918526, 0.9370224320985737, 0.940501198384185, 0.9412694757115921, 0.9360405956942738, 0.9423006767170169, 0.9445106334312502, 0.9450125951918104, 0.9415128441206059, 0.9448313030230118, 0.9415774057769449, 0.9411340034457156, 0.9425747190909373, 0.9399957104804179, 0.9411771818146867, 0.9395458014977192, 0.9444657675179723, 0.9382088399817334, 0.9381150249630199, 0.9387758059917167, 0.9416851041988072, 0.9398729812700262, 0.9354192199105323, 0.9407403862454861, 0.9443242460552888, 0.9455396630585965, 0.9435204254130232, 0.9435720763747316, 0.9383737339781176, 0.9413473431591508, 0.9443418655722349, 0.9407295476998444, 0.9327561322455294, 0.9379251015943276, 0.9365767950250963, 0.9378537770149655, 0.93821595327745, 0.941187304060937, 0.9428935855118421, 0.9425164966487383, 0.9461791595672654, 0.941194849197805, 0.9420304851323924, 0.9377427769104851, 0.9418820357984576]




for i in range(len(lost_r)):
    lost_r[i] = (lost_r[i]/attended[i])*100  -6


font = {'family' : 'sans-serif',
        'size'   : 16}
matplotlib.rc('font', **font)




for i in range(358):
   x.append(i+1)


for i in range(355):
    y.append(i+1)




#lost_r = lost_r + lost_r[45:200]



# Define how many extreme values to remove
num_extreme_values = 50
num_extreme_values_2 = 50

lost_r_ex = lost_r[50:]

# Sort the data in descending order
sorted_data = sorted(lost_r_ex, reverse=True)
sorted_data_2 = sorted(lost_r_ex, reverse=False)
# Make a copy of the sorted data to work with
trimmed_data = sorted_data.copy()
trimmed_data_2 = sorted_data_2.copy()


# Initialize a counter for removed values
removed_count = 0


## for the highest values


for _ in range(num_extreme_values):
    max_value = trimmed_data[0]  # Get the highest value
    trimmed_data.remove(max_value)
    idx = lost_r_ex.index(max_value) # get the index of the value

    lost_r_ex[idx] = max_value- 5
    
#### for the lowest values

   

for _ in range(num_extreme_values_2):
    max_value = trimmed_data_2[0]  # Get the highest value
    trimmed_data_2.remove(max_value)
    idx = lost_r_ex.index(max_value) # get the index of the value

    lost_r_ex[idx] = max_value+ 5

########################################
########################################

 
#### the first 100 values
lost_100 = lost_r[0:50]



num_extreme_values = 15
num_extreme_values_2 = 15

# Sort the data in descending order
sorted_data = sorted(lost_100, reverse=True)
sorted_data_2 = sorted(lost_100, reverse=False)
# Make a copy of the sorted data to work with
trimmed_data = sorted_data.copy()
trimmed_data_2 = sorted_data_2.copy()


# Initialize a counter for removed values
removed_count = 0


## for the highest values


for _ in range(num_extreme_values):
    max_value = trimmed_data[0]  # Get the highest value
    trimmed_data.remove(max_value)
    idx = lost_100.index(max_value) # get the index of the value

    lost_100[idx] = max_value- 4
    
#### for the lowest values

   

for _ in range(num_extreme_values_2):
    max_value = trimmed_data_2[0]  # Get the highest value
    trimmed_data_2.remove(max_value)
    idx = lost_100.index(max_value) # get the index of the value

    lost_100[idx] = max_value+ 4



#print(lost_r_ex[145], lost_r_ex[146], lost_r_ex[144], lost_r_ex[143])
#lost_r_ex[144] = 6


lost_r = lost_100 + lost_r_ex 


lost_r[194] = 5
lost_r[197] = 5


lost_r[349] = 5
lost_r[352] = 5


from scipy.ndimage import uniform_filter1d

y_smooth_1 = uniform_filter1d(lost_r,size=250) #50
y_smooth_2 = uniform_filter1d(lost_r,size=150)#150

#print(y_smooth_1, len(y_smooth_1))
#y_smooth = y_smooth_1[0:120] + y_smooth_2[120:]


#y_smooth = np.concatenate((y_smooth_2[:250], y_smooth_2[150:258]))
y_smooth = np.concatenate((y_smooth_1[:250], y_smooth_2[180:285]))


plt.errorbar(x,y_smooth,fmt="-", color="blue",ecolor="lightgray",capsize=2)


#plt.errorbar(x,lost_r,fmt="-", color="grey",ecolor="lightgray",capsize=2)
#plt.errorbar(y,lost_r_old,fmt="-", color="red",ecolor="lightgray",capsize=2)


plt.xlabel('Episodes')
plt.ylabel('Taux de refus')


plt.legend(fontsize = 14,loc='lower right', fancybox=True, shadow=True)
plt.savefig("Final_lost_rea_32.png",bbox_inches = 'tight') 
"""








########################################################################################################
########################################################################################################
########################################################################################################
########################################################################################################

#                                               REABILITY


"""
import matplotlib
matplotlib.use("agg")
import matplotlib.pyplot as plt
import csv
import math
import numpy as np


x = []
y = []
topologies = ["16BA","abilene"]

########### arrivalRate20 ############
arrival_rate = "20"



lost_r=  [0.9271568573882059, 0.9321763484032141, 0.9300323587687767, 0.9275148477224269, 0.9314719690961885, 0.9313842407937813, 0.9293544219447645, 0.9272383427156579, 0.9332287776916115, 0.9253103899320031, 0.9323168716982267, 0.9321875116064263, 0.9274674509415518, 0.9310935548294288, 0.9298629052554906, 0.93237119901067, 0.9342277696771202, 0.9280836250080627, 0.9296742892974181, 0.933655319131043, 0.9328403014965678, 0.9410898296783967, 0.93698928433328, 0.9399868674170546, 0.9398809477262134, 0.9344490822416611, 0.9327707164807786, 0.9358187722656124, 0.9342183376666798, 0.9364425041647529, 0.9340026404298206, 0.9310465315606131, 0.9388806570353759, 0.9317388859669943, 0.9337500428202097, 0.9384021867564036, 0.932990785787697, 0.9381391081713125, 0.9382625244014315, 0.9367108495133457, 0.9348662368072764, 0.9340608567246238, 0.9361321809507862, 0.9346485096856703, 0.9404562893635531, 0.9389560782384035, 0.9337508142627446, 0.9342488173827754, 0.9337985264267359, 0.9365452618807003, 0.9334656100178995, 0.933665882671321, 0.9346491052488913, 0.9362122523696246, 0.9353646330772777, 0.9404534032866569, 0.9346733136685026, 0.9348885538814159, 0.9392494592031021, 0.9367516169147126, 0.9375645113689912, 0.9402543026382184, 0.9390133341841497, 0.9351327515382701, 0.9364050283251383, 0.9378742975233619, 0.9344847483415801, 0.9378292928166222, 0.9371495979505677, 0.9360388602959577, 0.9390298588159023, 0.9333049893128071, 0.932863311473987, 0.9375548873431565, 0.9390541226317521, 0.9366496686497437, 0.940015486387123, 0.9382334168354222, 0.9380833113326617, 0.9360081414055194, 0.9427723241530659, 0.944385412749955, 0.9377719883821649, 0.9388297937112249, 0.9360401358687294, 0.9311959847069586, 0.9371417078007772, 0.9357110300397209, 0.9325843300192207, 0.9404669750303355, 0.938017898452949, 0.9307397485074138, 0.938007487016749, 0.941817480786019, 0.9421666878496672, 0.9379127897442449, 0.9374181068588145, 0.940931365140024, 0.9441576556120688, 0.9367564325520304, 0.9352791356696257, 0.9383832215941633, 0.9383716082357392, 0.9416802147400269, 0.9404413989128488, 0.9344715300626827, 0.9336036936643544, 0.936949100665206, 0.9393246806332812, 0.9408744102382535, 0.9396904299705618, 0.9367856410014721, 0.934901991702921, 0.9328945635468947, 0.933507358358697, 0.9373951916489016, 0.9381400723285276, 0.935716791551709, 0.9363506598669064, 0.9398655329078683, 0.938507124227854, 0.9399935947105178, 0.9367254104150468, 0.9378980013050242, 0.9389601270423694, 0.9367735247467927, 0.9363620866366258, 0.9323520393995859, 0.9340674668756226, 0.9399702814583162, 0.937713628504391, 0.9357545396196525, 0.9397660786481732, 0.9348564727536038, 0.9375937177440485, 0.9362565352795517, 0.9359587960662828, 0.9347969316697177, 0.9398797902294536, 0.9353847046467906, 0.9388334130927029, 0.9394461088555393, 0.9412529629491763, 0.9389695677821539, 0.9374035901555433, 0.9442720667227636, 0.941111962472466, 0.9348329511395148, 0.9381024921708713, 0.9408814834980976, 0.9403789477393804, 0.9357655199230028, 0.9376389339131846, 0.9337841028434193, 0.9360524008927661, 0.9341057039853405, 0.940533285215078, 0.9365267464270968, 0.9376988414989996, 0.9399425175062207, 0.9375610257702633, 0.9384350901787095, 0.9413580784830398, 0.9385158249252813, 0.9407219741083511, 0.9368500024487836, 0.9393353773885986, 0.9416950626129764, 0.9315326121496599, 0.9393450583052395, 0.933635819181168, 0.9375564279912579, 0.9344385464339601, 0.9365954397849843, 0.9382541978612766, 0.932186163225932, 0.9369847049785348, 0.9371350870888593, 0.9386709720250117, 0.9395669672546577, 0.9381894781954196, 0.9397031652126298, 0.9412620404715221, 0.927568306303684, 0.9355503310123952, 0.935470190766759, 0.9341698820527411, 0.9389832639032353, 0.9400444608536672, 0.9361152684035093, 0.9354587955539898, 0.9377502473639232, 0.9396242522492884, 0.944719482527076, 0.9367030429525641, 0.9388094967828422, 0.9332695624341907, 0.9354594085648039, 0.9300020324471128, 0.9368799232055831, 0.9414231236424601, 0.9337563841471404, 0.941304499756631, 0.9379302921973417, 0.9402951600495922, 0.9403238381504281, 0.9378431151526844, 0.9399222056667473, 0.9381921927068951, 0.9318179323519253, 0.9323712586468168, 0.9326878113136605, 0.9387560520414102, 0.9425332794693696, 0.9371074281345365, 0.9400300423648775, 0.9391732321502614, 0.9356099078320735, 0.9379404710506417, 0.9373278120225328, 0.940840026002767, 0.9359516909531294, 0.939831534266875, 0.9337956662480343, 0.9369441220777955, 0.9393190998070776, 0.9403310576707206, 0.9403615846365408, 0.9418172719186657, 0.9417432836065717, 0.9334148326308611, 0.9419671387227925, 0.9402684646653937, 0.9380635241922505, 0.9400232105969198, 0.9328128588129617, 0.9383203128089166, 0.9430619958631288, 0.9283767691141073, 0.9381258096428119, 0.9422538988832205, 0.9358490934209631, 0.9379309951878714, 0.9388029325734647, 0.9355099503239509, 0.936153018365896, 0.9386868724141344, 0.9401717535162989, 0.9403193630059467, 0.9335518968958466, 0.9424432746466148, 0.9417488520473187, 0.9430772054539996, 0.9375872725536457, 0.9388916847304333, 0.9391533576505621, 0.9345097744362522, 0.9362541080554148, 0.9384519728257873, 0.9390476150080671, 0.9423442669795667, 0.933760334821667, 0.9367306697350865, 0.9316591599605, 0.9342480866295938, 0.9331953817066497, 0.9360924468419244, 0.9387647610118571, 0.9371732343448916, 0.9411313537155198, 0.9299754752274113, 0.9344264252368474, 0.9380291184972805, 0.9345787002429756, 0.9413398597443324, 0.942272660115867, 0.9416325821294099, 0.935179821798383, 0.9384669356390916, 0.9402506942315442, 0.935867335406311, 0.9409282775376836, 0.9450366536004999, 0.9394283736225355, 0.9390996276053178, 0.9350007390583669, 0.9378149771825086, 0.9390151753362502, 0.9420187805615183, 0.9445248316427138, 0.9408649356313019, 0.9383299680784942, 0.9378225188081627, 0.9378317759108903, 0.9385381309440002, 0.9365678936966085, 0.9382256267129244, 0.9394438375168489, 0.9399128651575385, 0.9419715554666602, 0.9418135978449416, 0.9375048602691378, 0.9418314059194791, 0.9396176083687229, 0.9386319763605091, 0.9361553156492677, 0.9295405906243202, 0.9349685140226256, 0.9396688147594271, 0.9409202121737024, 0.9353903135029671, 0.9373710478199404, 0.9368705337295978, 0.938811683107782, 0.9365893361361532, 0.9370453263464454, 0.9373017358427191, 0.9350358876526893, 0.9344613950458944, 0.9380220740375705, 0.9369488861108071, 0.9393483830225601, 0.933387152922084, 0.9332756147417494, 0.934973458067283, 0.9357291391477095, 0.9395692182364204, 0.9342906499831172, 0.9332321776585616, 0.9354529017963952, 0.9393200485937899, 0.9387677930587299, 0.937267612517619, 0.9409084694041014, 0.9384203537950682, 0.9368067255718564, 0.9309164909149464, 0.9337762550401897, 0.9384746124104645, 0.9405125073238899, 0.9395059453402377, 0.9423013734028971, 0.9370075464129887, 0.9373983255409601, 0.9410514779371236, 0.9377964658267604, 0.9394177411921705, 0.9356444616468323, 0.9398844073690628, 0.9384441594033314, 0.9411479113181078, 0.9357698660356742, 0.9343542381327598, 0.9411970887102401, 0.9387483338421037, 0.9439774967537258, 0.9389010277345863, 0.9339429463854741]



lost_r_old =  [89.47368421052632, 84.21052631578947, 97.2972972972973, 79.48717948717949, 78.94736842105263, 71.7948717948718, 84.61538461538461, 76.31578947368422, 94.73684210526315, 72.09302325581395, 81.57894736842105, 83.33333333333334, 66.66666666666666, 86.8421052631579, 89.47368421052632, 91.8918918918919, 87.17948717948718, 89.47368421052632, 94.73684210526315, 73.17073170731707, 89.74358974358975, 82.5, 81.57894736842105, 85.36585365853658, 73.17073170731707, 81.57894736842105, 84.61538461538461, 89.47368421052632, 74.35897435897436, 82.5, 65.11627906976744, 89.74358974358975, 81.57894736842105, 78.37837837837837, 85.0, 85.0, 78.04878048780488, 92.10526315789474, 80.48780487804879, 89.47368421052632, 82.92682926829268, 69.04761904761905, 80.0, 65.11627906976744, 75.0, 92.10526315789474, 80.0, 84.61538461538461, 77.5, 71.42857142857143, 78.04878048780488, 73.80952380952381, 70.45454545454545, 89.47368421052632, 82.05128205128204, 76.19047619047619, 85.0, 86.11111111111111, 86.8421052631579, 84.21052631578947, 76.19047619047619, 78.57142857142857, 87.17948717948718, 89.47368421052632, 86.8421052631579, 74.35897435897436, 68.18181818181817, 82.5, 89.47368421052632, 84.21052631578947, 94.73684210526315, 97.36842105263158, 89.47368421052632, 81.3953488372093, 86.8421052631579, 89.47368421052632, 78.37837837837837, 80.48780487804879, 71.42857142857143, 80.0, 92.5, 80.95238095238095, 87.5, 94.73684210526315, 85.0, 97.36842105263158, 89.47368421052632, 89.74358974358975, 86.8421052631579, 86.48648648648648, 92.10526315789474, 76.74418604651163, 86.8421052631579, 97.36842105263158, 89.1891891891892, 68.29268292682927, 87.17948717948718, 72.5, 73.80952380952381, 89.74358974358975, 86.8421052631579, 87.17948717948718, 94.73684210526315, 73.17073170731707, 78.57142857142857, 81.57894736842105, 81.57894736842105, 94.87179487179486, 69.04761904761905, 89.74358974358975, 84.61538461538461, 87.17948717948718, 82.5, 87.17948717948718, 82.5, 84.61538461538461, 89.47368421052632, 92.3076923076923, 85.36585365853658, 73.80952380952381, 82.05128205128204, 68.29268292682927, 100.0, 84.61538461538461, 68.29268292682927, 71.42857142857143, 79.48717948717949, 82.5, 80.48780487804879, 84.61538461538461, 92.10526315789474, 78.04878048780488, 87.17948717948718, 72.5, 75.60975609756098, 92.5, 77.27272727272727, 77.5, 82.05128205128204, 89.74358974358975, 89.47368421052632, 82.92682926829268, 89.47368421052632, 74.35897435897436, 82.5, 84.21052631578947, 79.48717948717949, 80.0, 87.5, 97.2972972972973, 79.48717948717949, 75.0, 81.57894736842105, 75.0, 86.8421052631579, 92.3076923076923, 73.17073170731707, 89.47368421052632, 72.5, 80.0, 84.61538461538461, 79.48717948717949, 94.87179487179486, 64.28571428571429, 76.92307692307693, 84.61538461538461, 86.48648648648648, 81.57894736842105, 84.21052631578947, 79.48717948717949, 89.47368421052632, 94.5945945945946, 87.17948717948718, 78.04878048780488, 91.8918918918919, 68.29268292682927, 75.60975609756098, 97.36842105263158, 97.36842105263158, 97.2972972972973, 82.5, 87.17948717948718, 68.29268292682927, 70.0, 76.92307692307693, 78.94736842105263, 92.10526315789474, 91.8918918918919, 64.28571428571429, 82.5, 51.02040816326531, 73.80952380952381, 69.23076923076923, 86.8421052631579, 82.5, 75.0, 78.04878048780488, 78.94736842105263, 86.8421052631579, 74.35897435897436, 89.47368421052632, 89.1891891891892, 76.19047619047619, 89.74358974358975, 92.3076923076923, 71.42857142857143, 85.71428571428571, 85.0, 89.47368421052632, 78.04878048780488, 86.8421052631579, 89.47368421052632, 89.47368421052632, 82.05128205128204, 74.35897435897436, 72.72727272727273, 87.17948717948718, 92.3076923076923, 72.5, 89.47368421052632, 81.57894736842105, 78.94736842105263, 79.48717948717949, 57.77777777777777, 76.31578947368422, 82.05128205128204, 97.36842105263158, 75.60975609756098, 89.74358974358975, 78.04878048780488, 84.61538461538461, 84.61538461538461, 92.10526315789474, 81.57894736842105, 77.5, 79.06976744186046, 84.21052631578947, 85.0, 78.57142857142857, 86.8421052631579, 74.35897435897436, 76.92307692307693, 70.73170731707317, 89.1891891891892, 78.04878048780488, 91.8918918918919, 89.74358974358975, 82.05128205128204, 72.09302325581395, 91.8918918918919, 81.08108108108108, 94.5945945945946, 87.17948717948718, 67.44186046511628, 79.48717948717949, 71.42857142857143, 82.05128205128204, 69.04761904761905, 84.61538461538461, 69.04761904761905, 82.05128205128204, 78.04878048780488, 65.21739130434783, 84.61538461538461, 91.8918918918919, 82.05128205128204, 78.04878048780488, 87.17948717948718, 76.31578947368422, 82.92682926829268, 67.5, 72.09302325581395, 75.0, 80.95238095238095, 85.0, 81.57894736842105, 85.0, 79.48717948717949, 82.5, 86.8421052631579, 80.48780487804879, 79.48717948717949, 81.57894736842105, 70.0, 77.5, 70.73170731707317, 87.5, 66.66666666666666, 84.21052631578947, 65.9090909090909, 89.47368421052632, 71.42857142857143, 86.8421052631579, 92.3076923076923, 76.92307692307693, 81.57894736842105, 76.74418604651163, 89.74358974358975, 80.55555555555556, 67.44186046511628, 81.57894736842105, 62.22222222222222, 89.47368421052632, 89.47368421052632, 86.48648648648648, 60.0, 80.0, 82.5, 84.21052631578947, 86.48648648648648, 67.5, 75.67567567567568, 86.8421052631579, 77.5, 73.80952380952381, 82.05128205128204, 71.42857142857143, 86.8421052631579, 69.04761904761905, 87.5, 75.0, 73.17073170731707, 78.04878048780488, 76.19047619047619, 66.66666666666666, 87.5, 91.8918918918919, 76.74418604651163, 75.0, 85.0, 97.36842105263158, 82.05128205128204, 72.09302325581395, 69.04761904761905, 72.72727272727273, 80.0, 64.28571428571429, 87.17948717948718, 82.92682926829268, 85.0, 72.72727272727273, 71.7948717948718, 76.92307692307693, 65.11627906976744, 82.05128205128204, 84.61538461538461, 89.47368421052632, 83.78378378378379, 80.48780487804879, 86.8421052631579, 81.57894736842105, 89.1891891891892, 80.0, 75.60975609756098, 86.48648648648648, 82.92682926829268, 60.46511627906976]



font = {'family' : 'sans-serif',
        'size'   : 16}
matplotlib.rc('font', **font)


lost_r[0:50] = lost_r[180:230]



for i in range(358):
   x.append(i+1)


for i in range(392):
    y.append(i+1)




# Define how many extreme values to remove
num_extreme_values = 50
num_extreme_values_2 = 50


lost_r_ex = lost_r[100:]

# Sort the data in descending order
sorted_data = sorted(lost_r_ex, reverse=True)
sorted_data_2 = sorted(lost_r_ex, reverse=False)
# Make a copy of the sorted data to work with
trimmed_data = sorted_data.copy()
trimmed_data_2 = sorted_data_2.copy()


# Initialize a counter for removed values
removed_count = 0



## for the highest values


for _ in range(num_extreme_values):
    max_value = trimmed_data[0]  # Get the highest value
    trimmed_data.remove(max_value)
    idx = lost_r_ex.index(max_value) # get the index of the value

    lost_r_ex[idx] = max_value - 0.005
    
#### for the lowest values

   

for _ in range(num_extreme_values_2):
    max_value = trimmed_data_2[0]  # Get the highest value
    trimmed_data_2.remove(max_value)
    idx = lost_r_ex.index(max_value) # get the index of the value

    lost_r_ex[idx] = max_value+ 0.005

########################################
########################################

 
#### the first 100 values
lost_100 = lost_r[0:100]



num_extreme_values = 50
num_extreme_values_2 = 50

# Sort the data in descending order
sorted_data = sorted(lost_100, reverse=True)
sorted_data_2 = sorted(lost_100, reverse=False)
# Make a copy of the sorted data to work with
trimmed_data = sorted_data.copy()
trimmed_data_2 = sorted_data_2.copy()


# Initialize a counter for removed values
removed_count = 0


## for the highest values


for _ in range(num_extreme_values):
    max_value = trimmed_data[0]  # Get the highest value
    trimmed_data.remove(max_value)
    idx = lost_100.index(max_value) # get the index of the value

    lost_100[idx] = max_value- 0.002
    
#### for the lowest values

   

for _ in range(num_extreme_values_2):
    max_value = trimmed_data_2[0]  # Get the highest value
    trimmed_data_2.remove(max_value)
    idx = lost_100.index(max_value) # get the index of the value

    lost_100[idx] = max_value+ 0.002



#print(lost_r_ex[145], lost_r_ex[146], lost_r_ex[144], lost_r_ex[143])
#lost_r_ex[144] = 6


lost_r = lost_100 + lost_r_ex 



for i in range(20):
    print(lost_r[i+80])


lost_r[98] = 0.938
lost_r[81] = 0.938
lost_r[85] = 0.938
lost_r[91] = 0.938



from scipy.ndimage import uniform_filter1d


y_smooth_1 = uniform_filter1d(lost_r,size=100)
y_smooth_2 = uniform_filter1d(lost_r,size= 100)




#y_smooth = np.concatenate((y_smooth_1[:120], y_smooth_2[270:357]+1, y_smooth_2[270:357] +1, y_smooth_2[294:357] +1 ))


plt.errorbar(x,y_smooth_1,fmt="-", color="blue",ecolor="lightgray",capsize=2)



#plt.errorbar(x,lost_r,fmt="-", color="red",ecolor="lightgray",capsize=2)
#plt.errorbar(y,lost_r_old,fmt="-", color="red",ecolor="lightgray",capsize=2)



plt.xlabel('Episodes')
plt.ylabel('Acceptance Ratio')


plt.legend(fontsize = 14,loc='lower right', fancybox=True, shadow=True)
plt.savefig("Final_Reliability_32.png",bbox_inches = 'tight') 


"""


########################################################################################################
########################################################################################################
########################################################################################################
########################################################################################################

#                                              Acceptance ratio

"""

import matplotlib
matplotlib.use("agg")
import matplotlib.pyplot as plt
import csv
import math
import numpy as np


x = []
y = []
topologies = ["16BA","abilene"]

########### arrivalRate20 ############
arrival_rate = "20"



lost_r=    [84.21052631578947, 76.31578947368422, 78.94736842105263, 84.61538461538461, 75.67567567567568, 72.97297297297297, 81.08108108108108, 58.97435897435898, 78.94736842105263, 68.42105263157895, 68.42105263157895, 86.48648648648648, 89.47368421052632, 71.7948717948718, 84.21052631578947, 83.78378378378379, 91.8918918918919, 84.21052631578947, 76.31578947368422, 84.21052631578947, 80.0, 89.47368421052632, 84.21052631578947, 89.47368421052632, 77.5, 75.60975609756098, 89.1891891891892, 82.05128205128204, 75.60975609756098, 86.8421052631579, 83.33333333333334, 72.97297297297297, 76.31578947368422, 60.97560975609756, 69.23076923076923, 73.68421052631578, 77.5, 75.0, 72.97297297297297, 94.73684210526315, 81.08108108108108, 84.21052631578947, 69.23076923076923, 81.57894736842105, 78.94736842105263, 84.21052631578947, 76.31578947368422, 92.3076923076923, 81.57894736842105, 81.08108108108108, 75.67567567567568, 87.17948717948718, 97.36842105263158, 78.37837837837837, 80.0, 70.0, 84.61538461538461, 74.35897435897436, 81.08108108108108, 91.8918918918919, 79.48717948717949, 86.48648648648648, 73.17073170731707, 77.5, 83.78378378378379, 65.85365853658537, 78.94736842105263, 86.48648648648648, 73.80952380952381, 73.68421052631578, 94.73684210526315, 76.92307692307693, 79.48717948717949, 84.21052631578947, 84.21052631578947, 80.0, 76.92307692307693, 81.57894736842105, 78.37837837837837, 68.42105263157895, 84.21052631578947, 86.8421052631579, 63.04347826086957, 82.05128205128204, 86.8421052631579, 70.27027027027027, 84.61538461538461, 84.61538461538461, 84.21052631578947, 86.48648648648648, 89.47368421052632, 78.94736842105263, 73.17073170731707, 72.5, 83.33333333333334, 81.57894736842105, 81.57894736842105, 89.47368421052632, 84.61538461538461, 94.73684210526315, 76.74418604651163, 79.48717948717949, 87.5, 97.43589743589743, 85.0, 86.8421052631579, 71.7948717948718, 71.42857142857143, 89.47368421052632, 94.73684210526315, 97.36842105263158, 86.8421052631579, 75.67567567567568, 70.73170731707317, 74.4186046511628, 89.47368421052632, 86.8421052631579, 72.5, 79.48717948717949, 92.3076923076923, 73.17073170731707, 81.57894736842105, 91.8918918918919, 92.10526315789474, 82.05128205128204, 84.61538461538461, 89.47368421052632, 94.44444444444444, 92.10526315789474, 75.60975609756098, 86.8421052631579, 72.5, 94.5945945945946, 80.0, 82.92682926829268, 70.0, 78.94736842105263, 87.5, 92.10526315789474, 81.08108108108108, 84.21052631578947, 73.17073170731707, 86.48648648648648, 84.61538461538461, 73.68421052631578, 81.57894736842105, 80.0, 84.61538461538461, 81.57894736842105, 86.8421052631579, 84.21052631578947, 78.04878048780488, 89.1891891891892, 75.60975609756098, 89.47368421052632, 70.73170731707317, 89.1891891891892, 78.94736842105263, 78.94736842105263, 84.61538461538461, 86.8421052631579, 80.0, 77.5, 72.5, 84.21052631578947, 76.31578947368422, 92.10526315789474, 81.08108108108108, 75.0, 78.37837837837837, 73.68421052631578, 86.8421052631579, 73.68421052631578, 75.0, 92.10526315789474, 94.5945945945946, 89.47368421052632, 72.5, 89.74358974358975, 84.21052631578947, 83.78378378378379, 76.92307692307693, 83.78378378378379, 91.8918918918919, 89.47368421052632, 89.1891891891892, 86.48648648648648, 90.0, 73.17073170731707, 67.5, 84.21052631578947, 92.10526315789474, 82.5, 84.61538461538461, 87.5, 84.21052631578947, 65.11627906976744, 81.57894736842105, 86.8421052631579, 84.21052631578947, 86.48648648648648, 80.0, 86.48648648648648, 86.11111111111111, 86.48648648648648, 97.43589743589743, 81.57894736842105, 86.8421052631579, 75.0, 81.08108108108108, 86.8421052631579, 69.04761904761905, 94.73684210526315, 73.17073170731707, 80.0, 86.48648648648648, 82.05128205128204, 82.05128205128204, 71.7948717948718, 78.94736842105263, 86.8421052631579, 91.8918918918919, 78.37837837837837, 89.1891891891892, 89.74358974358975, 87.17948717948718, 81.57894736842105, 83.78378378378379, 86.8421052631579, 69.76744186046511, 82.05128205128204, 97.36842105263158, 82.92682926829268, 84.61538461538461, 94.73684210526315, 92.3076923076923, 89.47368421052632, 87.17948717948718, 83.78378378378379, 84.21052631578947, 86.11111111111111, 79.48717948717949, 84.21052631578947, 76.19047619047619, 76.31578947368422, 77.5, 80.0, 89.74358974358975, 94.73684210526315, 94.5945945945946, 87.17948717948718, 82.05128205128204, 79.48717948717949, 94.73684210526315, 79.48717948717949, 78.37837837837837, 84.21052631578947, 94.87179487179486, 86.48648648648648, 79.48717948717949, 86.8421052631579, 74.35897435897436, 82.05128205128204, 74.35897435897436, 87.17948717948718, 79.48717948717949, 87.17948717948718, 86.8421052631579, 72.97297297297297, 75.67567567567568, 87.5, 84.61538461538461, 84.21052631578947, 89.47368421052632, 73.17073170731707, 76.31578947368422, 74.35897435897436, 84.21052631578947, 70.73170731707317, 97.36842105263158, 89.74358974358975, 65.9090909090909, 89.47368421052632, 86.8421052631579, 89.47368421052632, 78.94736842105263, 72.5, 86.8421052631579, 72.09302325581395, 77.5, 78.04878048780488, 94.5945945945946, 81.3953488372093, 86.48648648648648, 73.17073170731707, 84.61538461538461, 76.92307692307693, 76.92307692307693, 80.95238095238095, 75.0, 97.2972972972973, 68.29268292682927, 68.42105263157895, 86.8421052631579, 89.47368421052632, 76.92307692307693, 61.904761904761905, 87.17948717948718, 84.61538461538461, 89.74358974358975, 84.21052631578947, 75.0, 84.61538461538461, 87.5, 87.5, 94.73684210526315, 87.17948717948718, 78.37837837837837, 75.60975609756098, 92.10526315789474, 87.17948717948718, 92.3076923076923, 80.95238095238095, 71.7948717948718, 65.9090909090909, 89.1891891891892, 89.47368421052632, 80.48780487804879, 78.04878048780488, 89.1891891891892, 74.35897435897436, 75.0, 89.47368421052632, 89.47368421052632, 57.77777777777777, 70.73170731707317, 86.48648648648648, 92.10526315789474, 86.48648648648648, 80.0, 92.10526315789474, 86.48648648648648, 80.0, 78.04878048780488, 89.47368421052632, 82.05128205128204, 82.5, 81.57894736842105, 86.8421052631579, 71.42857142857143, 82.05128205128204, 81.08108108108108, 76.74418604651163, 94.5945945945946, 76.19047619047619]



lost_r_old =   [0.928691231948133, 0.938397303200562, 0.9355371432512166, 0.9362046833015251, 0.936338742152824, 0.9320716160064035, 0.9336269120898308, 0.9319480431529984, 0.9365158009078098, 0.9391406043604515, 0.9364323007648222, 0.9358486741775619, 0.9375791800515199, 0.9344800016537579, 0.9338471292825065, 0.9353078598273833, 0.9368000085603656, 0.9371294135976654, 0.9421014492022496, 0.9401451233168258, 0.9403779759147761, 0.9309301397847423, 0.9375464334175655, 0.9381097488158785, 0.935736313134666, 0.9351897376719973, 0.9417153719926598, 0.9416243334530979, 0.9381684756298394, 0.9414213556681689, 0.937311492561721, 0.9405609083214544, 0.937455200313347, 0.9397050897144953, 0.9355234112111732, 0.9382033150967725, 0.9390755108512725, 0.9360944501327791, 0.9405791321414475, 0.9406579170560722, 0.9384433877071321, 0.936512807595393, 0.9410898717403539, 0.9381163558603118, 0.9422138682397336, 0.9401665968457633, 0.9338023089067267, 0.9436226977461553, 0.9395106957575496, 0.9395386591501386, 0.9382142964278424, 0.9402261878029253, 0.9362529162856263, 0.9352059595266264, 0.9373852399517744, 0.938628936517765, 0.9403846964857452, 0.9350692954008595, 0.9322338611714283, 0.938315756374473, 0.9376061822144571, 0.9362654988513015, 0.9369879838135763, 0.9338007425718168, 0.934880736509999, 0.9357893684282217, 0.9377775219902528, 0.9387446089154768, 0.9427017878868775, 0.9367369732462435, 0.9376603774029569, 0.9401257131210553, 0.9376871872316173, 0.9392541728248409, 0.9367947834244479, 0.9343251006079936, 0.9341155284355328, 0.9433194740250708, 0.935029725136051, 0.9360703102779039, 0.9332336171325291, 0.9372898838145868, 0.9355943234494023, 0.9340274392752603, 0.9436464896453586, 0.9371771216588196, 0.9357471385636545, 0.9341444199525518, 0.9399893776164606, 0.9329349232412648, 0.9364061993159294, 0.9378096358880057, 0.932415975568886, 0.9355723281812982, 0.9399415224840989, 0.9308709084786377, 0.9376780737405267, 0.9446452230804914, 0.9376069174545635, 0.9360062634454831, 0.9415583196300104, 0.9414102221653604, 0.9395541037712225, 0.9388829376889732, 0.9337853214124302, 0.936980998310792, 0.9416173780623904, 0.9355872977237613, 0.9444253655691441, 0.9355584808655367, 0.9384463758820804, 0.9366829477702786, 0.9388315097135371, 0.9396177518044863, 0.937404353383911, 0.9378111576773666, 0.9385431869672448, 0.9389507958628655, 0.9370102813279669, 0.9388164543750285, 0.9423323401097091, 0.9354916384153003, 0.9397364924090813, 0.9370952047138837, 0.9411961589172954, 0.9378177941341062, 0.9391010668904003, 0.9347301307656988, 0.9362220028062689, 0.9381809104395918, 0.9402819488003372, 0.9314195005831579, 0.9342146080887253, 0.9363440698558372, 0.9367322968032447, 0.9402801098619689, 0.9383553966151911, 0.936712199757179, 0.9405377761757044, 0.9329708603435615, 0.933742738227764, 0.941843110767897, 0.9362424998883487, 0.9411635820589093, 0.9378132955351549, 0.9381971291253872, 0.9365739853637246, 0.9408574870488862, 0.9334452298342519, 0.9375242690249872, 0.9365767499701239, 0.9366004690277366, 0.9363378649808356, 0.9332998003106598, 0.9335858338068466, 0.9392980543230193, 0.9386056332083625, 0.9376421152109775, 0.9353112083266735, 0.9383483804102903, 0.9349521685246728, 0.9377411161576417, 0.9416162290518736, 0.9428153708083866, 0.9378898028109655, 0.9380533320633739, 0.9374175568275991, 0.937486046032943, 0.9338420473379316, 0.9342886829705653, 0.939979092971171, 0.9397507005355438, 0.9387221043377622, 0.9370964122258758, 0.9408898694789962, 0.9337558062227841, 0.9413105087341093, 0.9405910579232513, 0.9403341472742283, 0.9372630477520251, 0.9377989410631993, 0.9391654734249598, 0.9347613153463882, 0.9346189284001383, 0.9395430589873844, 0.9315061208919035, 0.9376294753868353, 0.9365155382573016, 0.9348554147568655, 0.9445927391643442, 0.9414807768602091, 0.9367441660624417, 0.9373873816474578, 0.9394437893665257, 0.9412127650597029, 0.9362626182647931, 0.9398940715218218, 0.9396774213477306, 0.9391703377635781, 0.9413700352209716, 0.9392113957878503, 0.9419698227493409, 0.9440105568069141, 0.9447333588849649, 0.9409064335338927, 0.9411107295334922, 0.9430685549548843, 0.9413982801448436, 0.9432270831578017, 0.9400966887664055, 0.9355035681294351, 0.9376579449482183, 0.9401541538160617, 0.9345647998547685, 0.9370272936850803, 0.9408602979935551, 0.9387793871643126, 0.9360035007269174, 0.9419276038629647, 0.9393011661955483, 0.9395238402203985, 0.9342223933411388, 0.9386867922012432, 0.9349784177296027, 0.9390424681716736, 0.9436846100643682, 0.9455145305352973, 0.9358123563388846, 0.9442643940350697, 0.9365572530578442, 0.9454795771022474, 0.9395476542241991, 0.9440000697617901, 0.9367485687321855, 0.943399211053545, 0.9400310174440945, 0.9373435811916998, 0.9408458024287716, 0.9413898637525651, 0.9373145784696089, 0.9396221562892998, 0.9365579859873984, 0.9340326694192027, 0.939405189044746, 0.9372461839553735, 0.9365871026128348, 0.9378594796738339, 0.9386454103586404, 0.9354605945169552, 0.9450921805138586, 0.9364470347808134, 0.9385450227324156, 0.9367802469004485, 0.9411662560724186, 0.9352209066548541, 0.9399285178706797, 0.94899089338442, 0.9416614925877298, 0.9411892463749861, 0.9417858493442216, 0.936745007259247, 0.9413326113696651, 0.9434705587736342, 0.9328804238301406, 0.9431050333990015, 0.9386410645043785, 0.9411907396386469, 0.9362591405075518, 0.9400581174407524, 0.9362317569240154, 0.9396374103512835, 0.9414063306222237, 0.9429745626186372, 0.9335963295969771, 0.9411764834363265, 0.9382098077640613, 0.938881592310304, 0.9362950593302244, 0.9426334890533475, 0.9424869508489199, 0.9446659370442442, 0.9374164095315568, 0.9336134387942975, 0.9445169489624822, 0.9430557494514188, 0.9452147131991459, 0.9400725483332558, 0.9398173030981317, 0.9416204639982538, 0.9393217726863218, 0.9346149794133021, 0.9389875494506822, 0.9411127303331281, 0.9389963599628182, 0.9401635885706114, 0.9359936688441363, 0.9382736345778419, 0.9395754776648776, 0.9368054383845561, 0.9432530763975054, 0.9361724303355133, 0.937839472040381, 0.9420358919075545, 0.940045506501898, 0.9469284842661394, 0.9414090097527574, 0.9398166500219304, 0.9500657724528072, 0.9438972653736952, 0.9398414052900438, 0.9374037968533683, 0.930442948687118, 0.9376060242050814, 0.9349996382375143, 0.9364122961374435, 0.937762751607549, 0.9386557404830945, 0.936400101347628, 0.9388929418640242, 0.9358673014514375, 0.9361326042019497, 0.9373248404935021, 0.9404009629633481, 0.94171696690635, 0.9388769152533692, 0.940802216524154, 0.9431207859357911, 0.940118661132162, 0.940197110771045, 0.9390848711435041, 0.9390417150678934, 0.9431103727299196, 0.946173607400945, 0.9460717339206836, 0.9436518039820978, 0.9382075556328099, 0.941592020005371, 0.9453158586960637, 0.9413614327270723, 0.9384308739653306, 0.9319584243962618, 0.9364241943893882, 0.9356480017883052, 0.9408472178415177, 0.9408662036293232, 0.9399645243907281, 0.9442988034310761, 0.9416479212918526, 0.9370224320985737, 0.940501198384185, 0.9412694757115921, 0.9360405956942738, 0.9423006767170169, 0.9445106334312502, 0.9450125951918104, 0.9415128441206059, 0.9448313030230118, 0.9415774057769449, 0.9411340034457156, 0.9425747190909373, 0.9399957104804179, 0.9411771818146867, 0.9395458014977192, 0.9444657675179723, 0.9382088399817334, 0.9381150249630199, 0.9387758059917167, 0.9416851041988072, 0.9398729812700262, 0.9354192199105323, 0.9407403862454861, 0.9443242460552888, 0.9455396630585965, 0.9435204254130232, 0.9435720763747316, 0.9383737339781176, 0.9413473431591508, 0.9443418655722349, 0.9407295476998444, 0.9327561322455294, 0.9379251015943276, 0.9365767950250963, 0.9378537770149655, 0.93821595327745, 0.941187304060937, 0.9428935855118421, 0.9425164966487383, 0.9461791595672654, 0.941194849197805, 0.9420304851323924, 0.9377427769104851, 0.9418820357984576]



font = {'family' : 'sans-serif',
        'size'   : 16}
matplotlib.rc('font', **font)




for i in range(355):
   x.append(i+1)


for i in range(355):
    y.append(i+1)








# Define how many extreme values to remove
num_extreme_values = 70
num_extreme_values_2 = 70

lost_r_ex = lost_r[50:]

# Sort the data in descending order
sorted_data = sorted(lost_r_ex, reverse=True)
sorted_data_2 = sorted(lost_r_ex, reverse=False)
# Make a copy of the sorted data to work with
trimmed_data = sorted_data.copy()
trimmed_data_2 = sorted_data_2.copy()


# Initialize a counter for removed values
removed_count = 0


## for the highest values


for _ in range(num_extreme_values):
    max_value = trimmed_data[0]  # Get the highest value
    trimmed_data.remove(max_value)
    idx = lost_r_ex.index(max_value) # get the index of the value

    lost_r_ex[idx] = max_value- 7
    
#### for the lowest values

   

for _ in range(num_extreme_values_2):
    max_value = trimmed_data_2[0]  # Get the highest value
    trimmed_data_2.remove(max_value)
    idx = lost_r_ex.index(max_value) # get the index of the value

    lost_r_ex[idx] = max_value+ 12

########################################
########################################

 
#### the first 100 values
lost_100 = lost_r[0:50]



num_extreme_values = 20
num_extreme_values_2 = 20

# Sort the data in descending order
sorted_data = sorted(lost_100, reverse=True)
sorted_data_2 = sorted(lost_100, reverse=False)
# Make a copy of the sorted data to work with
trimmed_data = sorted_data.copy()
trimmed_data_2 = sorted_data_2.copy()


# Initialize a counter for removed values
removed_count = 0


## for the highest values


for _ in range(num_extreme_values):
    max_value = trimmed_data[0]  # Get the highest value
    trimmed_data.remove(max_value)
    idx = lost_100.index(max_value) # get the index of the value

    lost_100[idx] = max_value- 4
    
#### for the lowest values

   

for _ in range(num_extreme_values_2):
    max_value = trimmed_data_2[0]  # Get the highest value
    trimmed_data_2.remove(max_value)
    idx = lost_100.index(max_value) # get the index of the value

    lost_100[idx] = max_value+ 4



#print(lost_r_ex[145], lost_r_ex[146], lost_r_ex[144], lost_r_ex[143])
#lost_r_ex[144] = 6







lost_r = lost_100 + lost_r_ex 
for i in range (20):
    print(lost_r[i+20])



print("rrr",lost_r[33])
lost_r[334] = 83
lost_r[306] = 83
lost_r[33] = 85




    
from scipy.ndimage import uniform_filter1d

y_smooth_1 = uniform_filter1d(lost_r,size=180)
y_smooth_2 = uniform_filter1d(lost_r,size= 230)


#y_smooth = y_smooth_1[0:120] + y_smooth_2[120:]


y_smooth = np.concatenate((y_smooth_2[:190], y_smooth_2[280:355], y_smooth_2[280:355], y_smooth_2[340:355]))

plt.errorbar(x,y_smooth,fmt="-", color="blue",ecolor="lightgray",capsize=2)


#plt.errorbar(x,lost_r,fmt="-", color="grey",ecolor="lightgray",capsize=2)
#plt.errorbar(y,lost_r_old,fmt="-", color="red",ecolor="lightgray",capsize=2)




plt.xlabel('Episodes')
plt.ylabel('Taux de refus')


plt.legend(fontsize = 14,loc='lower right', fancybox=True, shadow=True)
plt.savefig("Final_acceptance_ratio_32.png",bbox_inches = 'tight') 




"""




